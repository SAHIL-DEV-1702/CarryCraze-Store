<%- include('./partials/header') %> <% if (error_msg && error_msg.length > 0) {
%>
<div
  class="absolute top-5 left-1/2 -translate-x-1/2 -translate-y-1/2 p-3 rounded-md bg-red-500"
>
  <span class="inline-block mt-1 mb-1 text-white"><%= error_msg[0] %></span>
</div>
<% } %> <% if (success_msg && success_msg.length > 0) { %>
<div
  class="absolute top-5 left-1/2 -translate-x-1/2 -translate-y-1/2 p-3 rounded-md bg-green-500"
>
  <span class="inline-block mt-1 mb-1 text-white"><%= success_msg[0] %></span>
</div>
<% } %>


<div class="w-full flex flex-col md:flex-row px-5 py-10 gap-10">
  <!-- Sidebar (collapsible on mobile) -->
  <div class="w-full md:w-1/4 flex flex-col gap-6">
    <!-- Sort By -->
    <div class="flex items-center justify-between md:justify-start gap-2">
      <h3 class="font-semibold">Sort by</h3>
      <form action="/shop" method="post">
        <select class="border px-2 py-1 rounded" name="sortby">
          <option value="popular">Popular</option>
          <option value="newest">Newest</option>
        </select>
      </form>
    </div>

    <!-- Collections -->
    <div class="flex flex-col mt-4 md:mt-20">
      <a class="block mb-2 hover:text-blue-500" href="">New Collection</a>
      <a class="block mb-2 hover:text-blue-500" href="">All Products</a>
      <a class="block mb-2 hover:text-blue-500" href="">Discounted Products</a>
    </div>

    <!-- Filters -->
    <div class="mt-4 md:mt-32">
      <a class="block mb-2 font-semibold">Filter by :</a>
      <a class="block mb-2 hover:text-blue-500" href="">Availability</a>
      <a class="block mb-2 hover:text-blue-500" href="">Discount</a>
    </div>
  </div>

  <!-- Products Grid -->
  <div
    class="w-full md:w-3/4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-5"
  >
    <% products.forEach((product) => { %>
    <div class="bg-white shadow rounded overflow-hidden">
      <!-- Product Image -->
      <div
        class="w-full h-48 flex items-center justify-center"
        style="background-color: <%= product.bgcolor %>"
      >
        <img
          class="h-40 sm:h-48 object-contain"
          src="data:image/jpeg;base64,<%= product.image.toString('base64') %>"
          alt="<%= product.name %>"
        />
      </div>

      <!-- Product Info -->
      <div
        class="flex justify-between items-center px-3 py-3 sm:px-4 sm:py-4"
        style="
          background-color: <%= product.panelcolor %>;
          color: <%= product.textcolor %>;
        "
      >
        <div>
          <h3 class="font-semibold text-sm sm:text-base">
            <%= product.name %>
          </h3>
          <h4 class="text-sm sm:text-base">â‚¹ <%= product.price %></h4>
        </div>
        <a
          class="w-7 h-7 flex items-center justify-center rounded-full bg-white"
          href="/addtocart/<%= product._id %>"
        >
          <i class="ri-add-line"></i>
        </a>
      </div>
    </div>
    <% }) %>
  </div>
</div>

<%- include('./partials/footer') %>
